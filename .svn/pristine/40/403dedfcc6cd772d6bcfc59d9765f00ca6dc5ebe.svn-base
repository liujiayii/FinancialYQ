<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<title>信息查询-工资表-详情</title>
<jsp:include page="nav.jsp"></jsp:include>
	<div class="content">
		<div class="sub-box">
			<div class="sub-right">
				<input type="button" value="返回" class="sub-but" onclick="javascript:history.back(-1);"/>
			</div>
		</div>
		<div class="control">
			<form action="##" method="post" enctype="multipart/form-data" id="save">
				<table class="control_tab">
					<tr>
						<td width="140px" class="tab_03"><b>工号</b></td>
						<td class="width_04">
						<input type="hidden" value="${salaryVo.id}" name="id" id="input_id">
						<input type="text" value="${salaryVo.job_number}" name="job_number" id="job_number"></td>
						<td width="140px" class="tab_03"><b>姓名</b></td>
						<td class="width_04"><input type="text" value="${salaryVo.name}" name="name" id="names" ></td>
						<td width="140px" class="tab_03"><b>职位</b></td>
						<td class="width_04"><input type="text" value="${salaryVo.post_name}" name="post_id" id="posts" ></td>
					</tr>
					<tr>
						<td colspan="2" class="Worknum font_color"></td>
						<td colspan="2" class="Names font_color"></td>
						<td colspan="2" class="Posts font_color"></td>
					</tr>
					<tr>
						<td width="140px" class="tab_03"><b>实际出勤</b></td>
						<td class="width_04"><input type="text" value="${salaryVo.real_attendance}" name="real_attendance" id="attendance" ></td>
						<td width="140px" class="tab_03"><b>天数</b></td>
						<td class="width_04"><input type="text" value="${salaryVo.num_day}" name="num_day" id="days"></td>
						<td width="140px" class="tab_03"><b>基本工资</b></td>
						<td class="width_04"><input type="text" value="${salaryVo.base_pay}" name="base_pay" id="wages"></td>
					</tr>
					<tr>
						<td colspan="2" class="Attend font_color"></td>
						<td colspan="2" class="Days font_color"></td>
						<td colspan="2" class="Wages font_color"></td>
					</tr>
					<tr>
						<td width="140px" class="tab_03"><b>业务工资</b></td>
						<td class="width_04"><input type="text" value="${salaryVo.business_pay}" name="business_pay" id="business" maxlength="6"></td>
						<td width="140px" class="tab_03"><b>原始股东分红</b></td>
						<td class="width_04"><input type="text" value="${salaryVo.original_dividend}" name="original_dividend" id="shares"   maxlength="6" onkeyup="clearNoNum(this)"></td>
						<td width="140px" class="tab_03"><b>全勤</b></td>
						<td class="width_04"><input type="text" value="${salaryVo.attendance_bouns}" name="attendance_bouns" id="fulltimes"  maxlength="6"></td>
					</tr>
					<tr>
						<td colspan="2" class="Business font_color"></td>
						<td colspan="2" class="Share font_color"></td>
						<td colspan="2" class="Fulltime font_color"></td>
					</tr>
					<tr>
						<td width="140px" class="tab_03"><b>工装</b></td>
						<td class="width_04"><input type="text" value="${salaryVo.forck_bouns}" id="forck_bouns" name="forck_bouns" maxlength="6"></td>
						<td width="140px" class="tab_03"><b>餐补</b></td>
						<td class="width_04"><input type="text" value="${salaryVo.meal_bouns}" id="meals" name="meal_bouns"></td>
						<td width="140px" class="tab_03"><b>保密金</b></td>
						<td class="width_04"><input type="text" value="${salaryVo.confidential_gold}" id="surance" name="confidential_gold" onkeyup="clearNoNum(this)"></td>
					</tr>
					<tr>
						<td colspan="2" class="ForckBouns font_color"></td>
						<td colspan="2" class="Times font_color"></td>
						<td colspan="2"></td>
					</tr>
					<tr>
						<td width="140px" class="tab_03"><b>业务提成</b></td>
						<td class="width_04"><input type="text" value="${salaryVo1.extract}" name="push_money" id="deduct" maxlength="6"></td>
						
						<td width="140px" class="tab_03"><b>理财提成</b></td>
						<td class="width_04"><input type="text" value="${json}" id="licai_deduct" maxlength="6"></td>
						<td width="140px" class="tab_03"><b>缺勤扣款</b></td>
						<td class="width_04"><input type="text" value="${salaryVo.absence_money}" id="detain" name="absence_money" onkeyup="clearNoNum(this)"></td>
						
					</tr>
					<tr>
						<td colspan="2" class="ForckBouns font_color"></td>
						<td colspan="2" class="Times font_color"></td>
						<td colspan="2"></td>
					</tr>
					<tr>
						<td width="140px" class="tab_03"><b>扣保险</b></td>
						<td class="width_04"><input type="text" value="${salaryVo.insurance_money}" name="insurance_money" id="insurance" maxlength="6" onkeyup="clearNoNum(this)"></td>
						<td width="140px" class="tab_03"><b>扣多发</b></td>
						<td class="width_04"><input type="text" value="${salaryVo.multiple_money}" id="issue" name="multiple_money" onkeyup="clearNoNum(this)"></td>
						<td width="140px" class="tab_03"><b>逾期扣</b></td>
						<td class="width_04"><input type="text" value="${salaryVo.overdue_money}" id="overdue" name="overdue_money" onkeyup="clearNoNum(this)"></td>
					</tr>
					<tr>
						<td colspan="2" class="ForckBouns font_color"></td>
						<td colspan="2" class="Times font_color"></td>
						<td colspan="2"></td>
					</tr>
					<tr>
					<td width="140px" class="tab_03"><b>未打卡</b></td>
						<td class="width_04"><input type="text" value="${salaryVo.no_clock}" id="Notclock" name="no_clock"></td>
						<td width="140px" class="tab_03"><b>罚款</b></td>
						<td class="width_04"><input type="text" value="${salaryVo.penalty_money}" name="penalty_money" id="fine" maxlength="6" onkeyup="clearNoNum(this)"></td>
						<td width="140px" class="tab_03"><b>实发工资</b></td>
						<td class="width_04"><input type="text" value="${salaryVo.real_salary}" id="money" name="real_salary"></td>
					</tr>
					<tr>
						<td colspan="2" class="ForckBouns font_color"></td>
						<td colspan="2" class="Times font_color"></td>
						<td colspan="2"></td>
					</tr>
					<tr>
						<td width="140px" class="tab_03"><b>备注</b></td>
						<td colspan="5"><input type="text" value="${salaryVo.remark}" name="remark" id="Tooling"></td>
					</tr>
					<tr><td colspan="6"></td></tr>
					
				</table>
				<p class="control_tab">
					<input type="button" value="编辑" class="bgbtn" id="sub_form" onclick="edit()">
					<input type="button" value="保存" class="bgbtn" style="background:#f45b63" onclick="update()">
				</p>
				
			</form>
		</div>
	</div>
<jsp:include page="footer.jsp"></jsp:include>
</body>
<script type="text/javascript">
	/*编辑，点击后需修改内容变为可修改，不修改内容变为不可用*/
	function edit(){
		$("#job_number").attr("disabled",true);
		$("#names").attr("disabled",true);
		$("#posts").attr("disabled",true);
		$("#attendance").attr("disabled",true);
		$("#days").attr("disabled",true);
		$("#wages").attr("disabled",true);
		$("#fulltimes").attr("disabled",true);
		$("#deduct").attr("disabled",true);
		$("#Notclock").attr("disabled",true);
		$("#forck_bouns").attr("disabled",true);
		$("#meals").attr("disabled",true);
		$("#licai_deduct").attr("disabled",true);
		$('#shares').click(function(){
			$(this).removeAttr('readonly');
		});
		$("#business").click(function(){
			$(this).removeAttr('readonly');
		});
		$('#Tooling').click(function(){
			$(this).removeAttr('readonly');
		});
		
		$('#surance').click(function(){
			$(this).removeAttr('readonly');
		});
		$('#detain').click(function(){
			$(this).removeAttr('readonly');
		});
		$('#insurance').click(function(){
			$(this).removeAttr('readonly');
		});
		$('#issue').click(function(){
			$(this).removeAttr('readonly');
		});
		$('#overdue').click(function(){
			$(this).removeAttr('readonly');
		});
		$('#fine').click(function(){
			$(this).removeAttr('readonly');
		});
		
	}
	$(function(){
		navSelected(2);	
		$("#save input").attr("readonly","readonly");
	});
	function update(){
		if($('#wages').val()==''){
			$('#wages').val(0);
		}
		if($('#business').val()==''){
			$('#business').val(0);
		}
		if($('#shares').val()==''){
			$('#shares').val(0);
		}
		if($('#fulltimes').val()==''){
			$('#fulltimes').val(0);
		}
		if($('#forck_bouns').val()==''){
			$('#forck_bouns').val(0);
		}
		if($('#meals').val()==''){
			$('#meals').val(0);
		}
		if($('#surance').val()==''){
			$('#surance').val(0);
		}
		if($('#deduct').val()==''){
			$('#deduct').val(0);
		}
		if($('#detain').val()==''){
			$('#detain').val(0);
		}
		if($('#Notclock').val()==''){
			$('#Notclock').val(0);
		}
		if($('#insurance').val()==''){
			$('#insurance').val(0);
		}
		if($('#issue').val()==''){
			$('#issue').val(0);
		}
		if($('#overdue').val()==''){
			$('#overdue').val(0);
		}
		if($('#fine').val()==''){
			$('#fine').val(0);
		}
		var sum=parseFloat($('#wages').val())+parseFloat($('#business').val())+parseFloat($('#shares').val())+parseFloat($('#fulltimes').val())+parseFloat($('#forck_bouns').val())+parseFloat($('#meals').val())+parseFloat($('#surance').val())+parseFloat($('#deduct').val())+parseFloat($("#licai_deduct").val())-parseFloat($('#detain').val())-parseFloat($('#Notclock').val())-parseFloat($('#insurance').val())-parseFloat($('#issue').val())-parseFloat($('#overdue').val())-parseFloat($('#fine').val());
		$('#money').val(sum);
		var id = $("#input_id").val();
		
	
		var formObject = {};

		var formArray =$("#save").serializeArray();

		$.each(formArray,function(i,item){

			formObject[item.name] = item.value;

		});
		var formJson = JSON.stringify(formObject);
		
		$.ajax({		
                type: "POST",
                dataType: "json",
                url: "updateRemark.action",
				data:formJson,
                contentType:'application/json',
                success: function (result) {
                    if (result.code == 0) {

                    	window.location.href="demandWage.action";
                    }          
                },
                error : function(result) {
                	window.wxc.xcConfirm("抱歉！出了一点小问题", window.wxc.xcConfirm.typeEnum.error);
                }
            });
	}	
</script>
<!--合计验证  -->
	<script type="text/javascript">
		function clearNoNum(obj) {
			//先把非数字的都替换掉，除了数字和.
			obj.value = obj.value.replace(/[^\d.]/g,"");
			//保证只有出现一个.而没有多个.
			obj.value = obj.value.replace(/\.{2,}/g,".");
			//必须保证第一个为数字而不是.
			obj.value = obj.value.replace(/^\./g,"");
			//保证.只出现一次，而不能出现两次以上
			obj.value = obj.value.replace(".","$#$").replace(/\./g,"").replace("$#$",".");
			//只能输入两个小数
			obj.value = obj.value.replace(/^(\-)*(\d+)\.(\d\d).*$/,'$1$2.$3');
			
		}
	</script>